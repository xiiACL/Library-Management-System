<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>๐ ููุชุจุชู</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-4 text-center">๐ ููุชุจุชู</h1>

    <form action="/Books" method="GET" class="mb-6 flex items-center gap-2 flex-wrap" id="searchForm">
      <input
        type="text"
        name="q"
        placeholder="ุงุจุญุซ ุนู ูุชุงุจ..."
        value="{{ search }}"
        class="flex-1 px-4 py-2 rounded border"
      />
      <select name="sort" class="px-3 py-2 border rounded" onchange="document.getElementById('searchForm').submit()">
        <option value="">๐ ุชุฑุชูุจ</option>
        <option value="last_read" {% if sort == 'last_read' %}selected{% endif %}>๐ ุงูุฃุญุฏุซ ูุฑุงุกุฉ</option>
        <option value="created_at" {% if sort == 'created_at' %}selected{% endif %}>๐๏ธ ุงูุฃุญุฏุซ ุฅุถุงูุฉ</option>
      </select>
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">๐ ุจุญุซ</button>
      <a href="/add" class="bg-green-600 text-white px-4 py-2 rounded">โ ุฅุถุงูุฉ ูุชุงุจ</a>
    </form>

    <h2 class="text-lg mb-4">๐ฆ ุนุฏุฏ ุงููุชุจ: {{ books|length }}</h2>

    <div class="grid gap-4">
      {% for book in books %}
      <div class="bg-white shadow-md rounded p-4 flex gap-4 items-center">
        {% if book[9] %}
          <img src="{{ url_for('uploaded_file', filename=book[9]) }}" alt="ุบูุงู ุงููุชุงุจ" class="w-48 h-auto rounded" />
        {% else %}
          <div class="w-48 h-64 bg-gray-300 rounded flex items-center justify-center text-gray-600">
            ูุง ุชูุฌุฏ ุตูุฑุฉ
          </div>
        {% endif %}

        <div class="flex-1">
          <p class="text-xl font-bold mb-2">{{ book[1] }}</p>
          <p>๐ค ุงููุคูู: {{ book[2] or 'ุบูุฑ ูุนุฑูู' }}</p>
          <p>๐ท๏ธ ุงูุชุตููู: {{ book[3] or 'ุบูุฑ ูุญุฏุฏ' }}</p>
          {% if book[12] %}
            <p>๐ ุงูุณูุณูุฉ: {{ book[12] }}{% if book[13] %} - ุงูุฌุฒุก {{ book[13] }}{% endif %}</p>
          {% endif %}
          <p>๐ ุงูุตูุญุฉ: {{ book[5] }}/{{ book[4] }}</p>
          <p>๐ ุงููุชุจูู: {{ book[4] - book[5] }} ุตูุญุฉ</p>
          <p>๐ ุชุงุฑูุฎ ุงูุดุฑุงุก: {{ book[6] or 'ุบูุฑ ูุญุฏุฏ' }}</p>
          {% if book[7] %}
            <p>๐ ุขุฎุฑ ูุฑุงุกุฉ: {{ book[7].replace('T', ' ') }}</p>
          {% else %}
            <p>๐ ุขุฎุฑ ูุฑุงุกุฉ: ุบูุฑ ูุญุฏุฏุฉ</p>
          {% endif %}
          <p>๐ ุงูููุน: {{ book[8] or 'ุบูุฑ ูุญุฏุฏ' }}</p>
          <p>๐๏ธ ุชุงุฑูุฎ ุงูุฅุถุงูุฉ: {{ book[10] or 'ุบูุฑ ูุชููุฑ' }}</p>
          <p>โ๏ธ ุขุฎุฑ ุชุนุฏูู: {{ book[11] or 'ุบูุฑ ูุชููุฑ' }}</p>

          <form action="/update_page/{{ book[0] }}" method="POST" class="mt-4 flex items-center gap-2 flex-wrap">
            <input
              type="number"
              name="current_page"
              min="0"
              max="{{ book[4] }}"
              value="{{ book[5] }}"
              class="w-24 px-2 py-1 border rounded"
              required
            />
            <button type="submit" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">๐พ ุชุญุฏูุซ ุงูุตูุญุฉ</button>
            <a href="/edit/{{ book[0] }}" class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600">โ๏ธ ุชุนุฏูู</a>
          </form>
        </div>
      </div>
      {% else %}
      <p class="text-center text-gray-500">ูุง ุชูุฌุฏ ูุชุจ ุญุงููุงู</p>
      {% endfor %}
    </div>
  </div>
</body>
</html>
